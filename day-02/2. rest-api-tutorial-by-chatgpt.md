চমৎকার — ঠিক যেটা তুমি চেয়েছো। আমি এখন প্রতিটি ফাইলে **প্রতিটি লাইন লেখার আগে** বলব:

* এখন আমি কি করব?
* কেন করব?
* কোন ভেরিয়েবল/ফাংশন নেব?
* পরে সেই লাইনের কোড দিব।

তুমি Node.js ব্যাকগ্রাউন্ড থেকে আসছ — প্রতিটা জায়গায় আমি **সংক্ষিপ্ত Node-Analogy** দেবো (Express/req/res, dotenv, bcrypt/jwt ইত্যাদি) যাতে তুমি সহজে মানচিত্র মিলিয়ে নিতে পারো।
সবকিছু **ফাংশনাল** (non-OOP)। চল শুরু করি — আমরা ছোট, কিন্তু production-সদৃশ **Login + Products + Checkout** API তৈরি করব।

> নোট: আমি প্রতিটি ফাইলে লাইন-পূর্বে ব্যাখ্যা করব। কোডগুলো একবারে কপি-পেস্ট করে চালাতে পারবে।

---

## ফাইল 1 — `.env` (root)

**কি করব:** `.env` ফাইল বানাবো — এখানে ডাটাবেস ও JWT config রাখব।
**কেন:** একটাই জায়গা থেকে সিক্রেট ও কনফিগ ম্যানেজ করব (Node: `process.env`).
**কি ভেরিয়েবল নেব:** DB_HOST, DB_NAME, DB_USER, DB_PASS, DB_CHARSET, JWT_SECRET, JWT_ALGO, JWT_EXPIRY

```text
# .env
DB_HOST=127.0.0.1
DB_NAME=mini_api
DB_USER=root
DB_PASS=
DB_CHARSET=utf8mb4

JWT_SECRET=change_this_to_a_secure_random_string
JWT_ALGO=HS256
JWT_EXPIRY=3600
```

---

## ফাইল 2 — `config/env.php`

**কি করব:** `.env` পড়ে associative array রিটার্ন করব এবং `$_ENV`-এ রাখব।
**কেন:** Node-এ `dotenv.config()` মত কাজ করবে — সব জায়গায় `include 'config/env.php'` করে ভ্যালু নেবে।
**কি ফাংশন নেব:** একটি ছোট `load_env()` যেটা ফাইল পড়ে key=value বের করবে।

**লাইন বুঝিয়ে লিখছি — পরে কোড:**

1. "এখন আমি ফাইলটি খুলব এবং লোড করার জন্য একটি ফাংশন ডিক্লেয়ার করব।"

```php
<?php
// config/env.php
function load_env($path) {
```

2. "এখন আমি চেক করব ফাইলটা আছে কি না — না থাকলে খালি array রিটার্ন করব।"

```php
  if (!file_exists($path)) return [];
```

3. "এখন আমি ফাইলের সব লাইন পড়ব, খালি লাইন ও কনট্রোল করে নেব।"

```php
  $lines = file($path, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);
  $env = [];
```

4. "প্রতিটি লাইন নিয়ে parse করব: comment লাইন বাদ দেব, তারপর KEY=VALUE অংশ আলাদা করব।"

```php
  foreach ($lines as $line) {
    if (strpos(trim($line), '#') === 0) continue;
    if (!strpos($line, '=')) continue;
    list($key, $val) = explode('=', $line, 2);
    $key = trim($key);
    $val = trim($val);
    if ((substr($val,0,1) === '"' && substr($val,-1) === '"') || (substr($val,0,1) === "'" && substr($val,-1) === "'")) {
      $val = substr($val, 1, -1);
    }
    $env[$key] = $val;
    $_ENV[$key] = $val;
  }
```

5. "লোড শেষে array রিটার্ন করব।"

```php
  return $env;
}

// auto-load and return env array on include
return load_env(__DIR__ . '/../.env');
```

**Node-Analogy:** `require('dotenv').config()` — এখন `include 'config/env.php'` করলে array পাবে।

---

## ফাইল 3 — `core/db.php`

**কি করব:** PDO দিয়ে DB connect করবে এমন একটি function বানাবো `db_connect()`।
**কেন:** প্রতিবার নতুন PDO তৈরির বদলে ফাংশন কল করলে সংযোগ পেয়ে যাবে — Node-এ `mysql.createPool()` ইত্যাদি ভাবো।
**কি ভেরিয়েবল নেব:** host, dbname, user, pass, charset (সব `.env` থেকে)

**লাইন-বাই-লাইন:**

1. "ফাইল শুরু করব এবং ফাংশন ডিফাইন করব।"

```php
<?php
// core/db.php
function db_connect() {
```

2. "এখন `.env` লোড করব; এখানে DB কনফিগ আছে।"

```php
  $cfg = include __DIR__ . '/../config/env.php';
```

3. "প্রত্যেক ভ্যালু আলাদা ভ্যারিয়েবলে রাখছি — যদি .env না থাকে তাহলে ডিফল্ট দেব।"

```php
  $host = $cfg['DB_HOST'] ?? '127.0.0.1';
  $dbname = $cfg['DB_NAME'] ?? 'mini_api';
  $user = $cfg['DB_USER'] ?? 'root';
  $pass = $cfg['DB_PASS'] ?? '';
  $charset = $cfg['DB_CHARSET'] ?? 'utf8mb4';
```

4. "DSN (Data Source Name) বানাবো — PDO তে ডাটাবেস কী ভাবে কানেক্ট করে সেটা বলে দেয়।"

```php
  $dsn = "mysql:host={$host};dbname={$dbname};charset={$charset}";
```

5. "PDO অপশনগুলো অরফান করা — errors exception ছুঁড়বে, fetch associative হবে, prepared emulation বন্ধ।"

```php
  $options = [
    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
    PDO::ATTR_EMULATE_PREPARES => false,
  ];
```

6. "এখন try/catch করে PDO বানাবো; fail হলে 500 রেসপন্স দিবো।"

```php
  try {
    return new PDO($dsn, $user, $pass, $options);
  } catch (PDOException $e) {
    http_response_code(500);
    header('Content-Type: application/json');
    echo json_encode(['error' => 'Database connection failed']);
    exit;
  }
}
```

**Node-Analogy:** `const pool = mysql.createPool({...})` — এখানে `db_connect()` PDO অবজেক্ট রিটার্ন করে, ঠিক যেমন Node-এ `pool.getConnection()` পাবো।

---

## ফাইল 4 — `core/jwt.php`

**কি করব:** base64url encode/decode ও jwt_encode/jwt_decode ফাংশন বানাবো।
**কেন:** JWT tokens বানাতে ও ভেরিফাই করতে প্রয়োজন। Node-এ `jsonwebtoken` প্যাকেজের মতো কাজ করবে।
**কি ভেরিয়েবল নেব:** secret, algo (env থেকে), expiry handled in payload

**লাইন-বাই-লাইন:**

1. "ফাইল শুরু ও base64url encode ফাংশন ডিফাইন করব — JWT এ URL-safe base64 লাগে।"

```php
<?php
// core/jwt.php

function base64url_encode($data) {
  return rtrim(strtr(base64_encode($data), '+/', '-_'), '=');
}
```

2. "এবং decode ফাংশন — padding ঠিক করে base64_decode চালাবো।"

```php
function base64url_decode($data) {
  $remainder = strlen($data) % 4;
  if ($remainder) $data .= str_repeat('=', 4 - $remainder);
  return base64_decode(strtr($data, '-_', '+/'));
}
```

3. "jwt_encode: header ও payload json encode করে base64url encode করব, তারপর secret দিয়ে signature বানাবো।"

```php
function jwt_encode(array $payload) {
  $cfg = include __DIR__ . '/../config/env.php';
  $header = ['alg' => ($cfg['JWT_ALGO'] ?? 'HS256'), 'typ' => 'JWT'];

  $headerEncoded = base64url_encode(json_encode($header));
  $payloadEncoded = base64url_encode(json_encode($payload));

  $secret = $cfg['JWT_SECRET'] ?? '';
  $signature = hash_hmac('sha256', "$headerEncoded.$payloadEncoded", $secret, true);
  $signatureEncoded = base64url_encode($signature);

  return "$headerEncoded.$payloadEncoded.$signatureEncoded";
}
```

4. "jwt_decode: token কে তিন ভাগে ভাগ করে signature verify এবং `exp` চেক করব।"

```php
function jwt_decode($token) {
  $cfg = include __DIR__ . '/../config/env.php';
  $parts = explode('.', $token);
  if (count($parts) !== 3) return false;

  list($headerEncoded, $payloadEncoded, $signatureEncoded) = $parts;

  $secret = $cfg['JWT_SECRET'] ?? '';
  $expected = hash_hmac('sha256', "$headerEncoded.$payloadEncoded", $secret, true);
  $signature = base64url_decode($signatureEncoded);

  if (!hash_equals($expected, $signature)) return false;

  $payload = json_decode(base64url_decode($payloadEncoded), true);
  if (!$payload || !is_array($payload)) return false;

  if (isset($payload['exp']) && time() > $payload['exp']) return false;

  return $payload;
}
```

**Node-Analogy:** `jwt.sign()` এবং `jwt.verify()` — এখানে আমরা ম্যানুয়ালি HMAC ও base64url করে যাচাই করছি।

---

## ফাইল 5 — `helpers/http.php`

**কি করব:** JSON input/response ও bearer token helper বানাবো।
**কেন:** Express এ `req.body`, `res.json()` ও `req.headers.authorization` আছে; এখানে একই সুবিধা আমাদের small helpers দিবে।

**লাইন-বাই-লাইন:**

1. "get_json_input — raw body পড়ে json_decode করে associative array দেবে।"

```php
<?php
// helpers/http.php

function get_json_input() {
  $raw = file_get_contents('php://input');
  $data = json_decode($raw, true);
  return is_array($data) ? $data : [];
}
```

2. "send_json — standardized JSON response দিয়ে exit করবে (Node: res.status().json())."

```php
function send_json($data, $status = 200) {
  http_response_code($status);
  header('Content-Type: application/json; charset=utf-8');
  echo json_encode($data, JSON_UNESCAPED_UNICODE);
  exit;
}
```

3. "respond_error — ছোট wrapper যাতে consistent error format আসে।"

```php
function respond_error($message = 'Error', $status = 400) {
  send_json(['error' => $message], $status);
}
```

4. "get_bearer_token — Authorization header থেকে Bearer token বের করবে।"

```php
function get_bearer_token() {
  if (function_exists('getallheaders')) {
    $headers = getallheaders();
    $auth = $headers['Authorization'] ?? $headers['authorization'] ?? null;
  } else {
    $auth = $_SERVER['HTTP_AUTHORIZATION'] ?? null;
  }
  if (!$auth) return null;
  if (stripos($auth, 'Bearer ') === 0) return trim(substr($auth, 7));
  return null;
}
```

---

## ফাইল 6 — `models/user.php`

**কি করব:** user সম্পর্কিত DB helper functions লিখব (find by email, find by id)।
**কেন:** Node-এ `User.findOne()`/`User.findByPk()` আছে; এখানে ছোট functions রাখব।
**কি ফাংশন নেবো:** `user_find_by_email($email)`, `user_find_by_id($id)`

**লাইন-বাই-লাইন:**

1. "ফাইল শুরু ও db require করব যাতে db_connect ব্যবহার করতে পারি।"

```php
<?php
// models/user.php
require_once __DIR__ . '/../core/db.php';
```

2. "user_find_by_email: prepared statement দিয়ে email দিয়ে user আনা হবে।"

```php
function user_find_by_email($email) {
  $pdo = db_connect();
  $stmt = $pdo->prepare('SELECT id, email, password FROM users WHERE email = ? LIMIT 1');
  $stmt->execute([$email]);
  return $stmt->fetch();
}
```

3. "user_find_by_id: id দিয়ে user info আনা হবে (password নেই)।"

```php
function user_find_by_id($id) {
  $pdo = db_connect();
  $stmt = $pdo->prepare('SELECT id, email FROM users WHERE id = ? LIMIT 1');
  $stmt->execute([(int)$id]);
  return $stmt->fetch();
}
```

---

## ফাইল 7 — `models/product.php`

**কি করব:** products এর helper functions বানাবো।
**কেন:** Node: `Product.findAll()` / `Product.findByPk()` মতো।
**কি ফাংশন:** `product_get_all()`, `product_get_by_id($id)`

**লাইন-বাই-লাইন:**

1. "DB include করে, query করবেন।"

```php
<?php
// models/product.php
require_once __DIR__ . '/../core/db.php';
```

2. "product_get_all — সব প্রোডাক্ট আনার জন্য simple query।"

```php
function product_get_all() {
  $pdo = db_connect();
  $stmt = $pdo->query('SELECT id, name, description, price FROM products ORDER BY id DESC');
  return $stmt->fetchAll();
}
```

3. "product_get_by_id — prepared statement দিয়ে single product।"

```php
function product_get_by_id($id) {
  $pdo = db_connect();
  $stmt = $pdo->prepare('SELECT id, name, description, price FROM products WHERE id = ? LIMIT 1');
  $stmt->execute([(int)$id]);
  return $stmt->fetch();
}
```

---

## ফাইল 8 — `controllers/auth_controller.php`

**কি করব:** login controller লিখব — ইনপুট validate, user fetch, password_verify, JWT বানানো।
**কেন:** Node: `authController.login(req,res)` — এখানেও একই flow।
**কি ফাংশন:** `login_controller()`

**লাইন-বাই-লাইন:**

1. "প্রয়োজনীয় মডেল/হেল্পার/জেডব্লিউটি include করছি।"

```php
<?php
// controllers/auth_controller.php
require_once __DIR__ . '/../models/user.php';
require_once __DIR__ . '/../core/jwt.php';
require_once __DIR__ . '/../helpers/http.php';
```

2. "login_controller ডিক্লেয়ার: request body পড়ব।"

```php
function login_controller() {
  $data = get_json_input();
```

3. "email এবং password বের করে validation করব (ফাঁকা হলে 400)।"

```php
  $email = isset($data['email']) ? trim($data['email']) : '';
  $password = $data['password'] ?? '';

  if ($email === '' || $password === '') {
    respond_error('Email and password are required', 400);
  }
```

4. "DB থেকে user আনা; না থাকলে 401।"

```php
  $user = user_find_by_email($email);
  if (!$user) respond_error('Invalid credentials', 401);
```

5. "password_verify দিয়ে পাসওয়ার্ড মিলানো; না হলে 401।"

```php
  if (!password_verify($password, $user['password'])) {
    respond_error('Invalid credentials', 401);
  }
```

6. "JWT payload বানাবো: sub=user id, iat, exp (env.jwt_expiry)।"

```php
  $cfg = include __DIR__ . '/../config/env.php';
  $now = time();
  $payload = [
    'sub' => (int)$user['id'],
    'email' => $user['email'],
    'iat' => $now,
    'exp' => $now + (int)($cfg['JWT_EXPIRY'] ?? 3600)
  ];
```

7. "token encode করে response পাঠাবো।"

```php
  $token = jwt_encode($payload);
  send_json(['token' => $token]);
}
```

**Node-Analogy:** `bcrypt.compare()` → `jwt.sign()` → `res.json({ token })` — একই ধারাবাহিকতা।

---

## ফাইল 9 — `controllers/product_controller.php`

**কি করব:** products list এবং single show controller।
**কেন:** express-এর controllers pattern অনুকরণ।
**ফাংশন:** `products_index_controller()`, `products_show_controller($id)`

**লাইন-বাই-লাইন:**

1. "include models এবং helper"

```php
<?php
// controllers/product_controller.php
require_once __DIR__ . '/../models/product.php';
require_once __DIR__ . '/../helpers/http.php';
```

2. "products_index_controller — সব প্রোডাক্ট নিয়ে send_json করব।"

```php
function products_index_controller() {
  $products = product_get_all();
  send_json($products);
}
```

3. "products_show_controller — id param দিয়ে product fetch, না থাকলে 404।"

```php
function products_show_controller($id) {
  $product = product_get_by_id($id);
  if (!$product) respond_error('Product not found', 404);
  send_json($product);
}
```

---

## ফাইল 10 — `controllers/checkout_controller.php`

**কি করব:** JWT-প্রটেক্টেড checkout controller — input validate, product check, simple total calculation। (ডেমো — orders টেবিল নেই)।
**কেন:** Node-এ যেভাবে `authMiddleware` পরে `checkoutHandler` চলে, এখানে token decode করে `checkout_controller($user_id)` কল করব।

**লাইন-বাই-লাইন:**

1. "include দরকারি মডেল ও হেল্পার"

```php
<?php
// controllers/checkout_controller.php
require_once __DIR__ . '/../models/product.php';
require_once __DIR__ . '/../models/user.php';
require_once __DIR__ . '/../helpers/http.php';
```

2. "checkout_controller definition — user_id parameter নিব (আভাবে middleware করে পাঠানো হবে)।"

```php
function checkout_controller($user_id) {
  $data = get_json_input();
  $product_id = $data['product_id'] ?? null;
  $quantity = isset($data['quantity']) ? (int)$data['quantity'] : 1;
```

3. "validation: product_id অবশ্যই দরকার, quantity কমপক্ষে 1।"

```php
  if (!$product_id) respond_error('product_id is required', 400);
  if ($quantity < 1) respond_error('quantity must be at least 1', 400);
```

4. "product ডাটাবেস থেকে নেবো; না থাকলে 404।"

```php
  $product = product_get_by_id($product_id);
  if (!$product) respond_error('Product not found', 404);
```

5. "user নিশ্চিত করব (token payload থেকে আসা user_id)।"

```php
  $user = user_find_by_id($user_id);
  if (!$user) respond_error('User not found', 401);
```

6. "total হিসাব করে JSON রেসপন্স দেবো (ডেমো)। production এ এখানে orders table insert ও transaction দরকার।"

```php
  $total = $product['price'] * $quantity;

  send_json([
    'user_id' => $user_id,
    'product' => $product,
    'quantity' => $quantity,
    'total' => $total,
    'message' => 'Checkout success (demo)'
  ]);
}
```

---

## ফাইল 11 — `routes/api.php`

**কি করব:** route dispatcher বানাবো — path ও method চেক করে কন্ট্রোলার কল করব; JWT middleware behaviour এখানে ইমপ্লিমেন্ট করব।
**কেন:** Express এর router অনুকরণ; এখানে সহজ `if/elseif` ব্যবহার করে route map করব।

**লাইন-বাই-লাইন:**

1. "প্রয়োজনীয় কন্ট্রোলার/হেল্পার/জেডব্লিউটি include করব।"

```php
<?php
// routes/api.php
require_once __DIR__ . '/../controllers/auth_controller.php';
require_once __DIR__ . '/../controllers/product_controller.php';
require_once __DIR__ . '/../controllers/checkout_controller.php';
require_once __DIR__ . '/../helpers/http.php';
require_once __DIR__ . '/../core/jwt.php';
```

2. "URI ও METHOD নিয়ে normalize করব (trailing slash remove)।"

```php
$uri = rtrim(parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH), '/');
$method = $_SERVER['REQUEST_METHOD'];
```

3. "POST /api/login -> login_controller()"

```php
if ($uri === '/api/login' && $method === 'POST') {
  login_controller();
}
```

4. "GET /api/products -> products_index_controller()"

```php
elseif ($uri === '/api/products' && $method === 'GET') {
  products_index_controller();
}
```

5. "GET /api/products/:id -> products_show_controller(id)"

```php
elseif (preg_match('#^/api/products/(\d+)$#', $uri, $matches) && $method === 'GET') {
  products_show_controller($matches[1]);
}
```

6. "POST /api/checkout -> protected: get token, decode, then checkout_controller(user_id)"

```php
elseif ($uri === '/api/checkout' && $method === 'POST') {
  $token = get_bearer_token();
  if (!$token) respond_error('Authorization token required', 401);
  $payload = jwt_decode($token);
  if (!$payload) respond_error('Invalid or expired token', 401);
  $user_id = $payload['sub'] ?? null;
  if (!$user_id) respond_error('Invalid token payload', 401);
  checkout_controller($user_id);
}
```

7. "নো-রুট হলে 404 রেসপন্স।"

```php
else {
  respond_error('Route not found', 404);
}
```

**Node-Analogy:** See `app.post('/api/checkout', authMiddleware, checkoutHandler)` — আমরা middleware manual way এ route block-এ করেছি।

---

## ফাইল 12 — `index.php` (entry point)

**কি করব:** সব রেসপন্স JSON করব এবং রাউট লোড করব।
**কেন:** Express এ `app.use(express.json())` ও route mounting মত।

**লাইন-বাই-লাইন:**

1. "PHP tag ও default JSON header set করব।"

```php
<?php
// index.php
header('Content-Type: application/json; charset=utf-8');
```

2. "পোড়া ত্রুটি দেখাবো development-এ; production এ বন্ধ রাখবে।"

```php
ini_set('display_errors', 1);
error_reporting(E_ALL);
```

3. "রাউটার include করে রিকোয়েস্ট হ্যান্ডল করব।"

```php
require_once __DIR__ . '/routes/api.php';
```

**Run:**

```bash
php -S localhost:8000
```

তারপর Postman/Browser-এ `http://localhost:8000/api/products` ইত্যাদি কল করো।

---

## ফাইল 13 — `scripts/create_user.php`

**কি করব:** CLI script বানাবো যেন সহজে user তৈরি করা যায় (hashed password)।
**কেন:** Node: `node seed.js` বা Sequelize seed-এ যেমন; এখানে CLI দিয়ে দ্রুত user তৈরি করতে পারবে।

**লাইন-বাই-লাইন:**

1. "db include"

```php
<?php
// scripts/create_user.php
require_once __DIR__ . '/../core/db.php';
```

2. "CLI arguments নেয়া (email, password)"

```php
$email = $argv[1] ?? null;
$password = $argv[2] ?? null;

if (!$email || !$password) {
  echo "Usage: php create_user.php user@example.com password\n";
  exit(1);
}
```

3. "password_hash করে insert করা"

```php
$hash = password_hash($password, PASSWORD_DEFAULT);

$pdo = db_connect();
$stmt = $pdo->prepare('INSERT INTO users (email, password) VALUES (?, ?)');
try {
  $stmt->execute([$email, $hash]);
  echo "User created: $email\n";
} catch (PDOException $e) {
  echo "Error: " . $e->getMessage() . "\n";
}
```

---

## DB Schema (SQL) — একই স্থানে রাখছি

**কি করব:** users ও products টেবিল তৈরি করব।
**কেন:** ডাটা রাখার মৌলিক টেবিল দরকার। Node: migrations/schema.sql

```sql
CREATE DATABASE IF NOT EXISTS mini_api CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE mini_api;

CREATE TABLE users (
  id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  email VARCHAR(255) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

CREATE TABLE products (
  id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  description TEXT,
  price DECIMAL(10,2) NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

INSERT INTO products (name, description, price) VALUES
('Laptop', 'Powerful laptop', 500.00),
('Mouse', 'Wireless mouse', 20.00);
```

---

## দ্রুত টেস্ট কেস (curl)

1. Create user (CLI)

```bash
php scripts/create_user.php user@example.com 123456
```

2. Login

```bash
curl -X POST http://localhost:8000/api/login \
 -H "Content-Type: application/json" \
 -d '{"email":"user@example.com","password":"123456"}'
```

3. Get products

```bash
curl http://localhost:8000/api/products
```

4. Checkout (use token from login)

```bash
curl -X POST http://localhost:8000/api/checkout \
 -H "Content-Type: application/json" \
 -H "Authorization: Bearer <TOKEN>" \
 -d '{"product_id":1,"quantity":2}'
```

---

## সংক্ষিপ্ত Security / Production টিপস (তুমি Node ব্যাকগ্রাউন্ডে বুঝবে)

* `.env` commit করো না; production এ OS env ব্যবহার করো (Docker secrets / cloud env vars)।
* HTTPS বাধ্যতামূলক — JWT ও password সরাসরি TLS ছাড়া পাঠিও না।
* JWT secret শক্তিশালী (e.g., `bin2hex(random_bytes(32))`).
* Orders-related multi-step ops হলেই DB transaction ব্যবহার করো (`$pdo->beginTransaction()` ...).
* Token revoke/blacklist লাগলে Redis/DB এ কাজ করবে।
* Input validation শক্ত করে রাখো (e.g., email filter_var, numeric checks)। Node: `express-validator` analogy।

---

## শেষ কথা (তুমি যা চেয়েছিলে)

* প্রতিটি লাইন লেখার আগে আমি বলেছি **এখন কি করব, কেন করব, কি নেব**, তারপর কোড দিলাম।
* পুরো টিউটোরিয়াল **ফাংশনাল**, **Node.js analogy** সহ, **MVC-like** pattern অনুসরণ করে।
* তুমি চাইলে আমি এখন **একই স্টাইলে** আরো এক ধাপ এগিয়ে **Orders table + transactional checkout** তৈরি করে (প্রতিটি লাইনের আগে সেই একই ধাঁচে ব্যাখ্যা করে) দেব। অথবা আমি প্রতিটি ফাইলকে একে একে একটি zip/গাইড হিসেবে সাজিয়ে দিতে পারি।

কোনটা আগে করব — `Orders (real checkout + DB transaction)` নাকি `Auth middleware reusable` বা `unit testing / deployment`?
